{% load tz %}
<!DOCTYPE html>
<html lang="ru">
          <td>
            <form method="post" action="/admin/game/{{ game.id }}/mark_answer/{{ a.id }}/" style="display:inline">
              {% csrf_token %}
              <input type="hidden" name="action" value="correct">
              <input type="hidden" name="next" value="{{ request.path }}">
              <button type="submit">✔️</button>
            </form>
            <form method="post" action="/admin/game/{{ game.id }}/mark_answer/{{ a.id }}/" style="display:inline;margin-left:6px">
              {% csrf_token %}
              <input type="hidden" name="action" value="incorrect">
              <input type="hidden" name="next" value="{{ request.path }}">
              <button type="submit">✖️</button>
            </form>
          </td>
      form.querySelector('input[name=action]').value = action;
      form.submit();
    }
  </script>
</head>
<body>
  <h1>Модерация ответов — вопрос: {{ question.text }}</h1>
  <a href="{% url 'admin_panel:manage_game' game.id %}">Назад к управлению</a>

  <table>
    <thead>
      <tr><th>Участник</th><th>Время</th><th>Статус</th><th>Ответ</th><th>Действия</th></tr>
    </thead>
    <tbody>
      {% for a in answers %}
        <tr class="{% if a.is_correct %}correct{% elif a.is_correct is False %}incorrect{% endif %}">
          <td>{% if a.team_name %}{{ a.team_name }}{% else %}{{ a.user_id }}{% endif %}</td>
          <td>{{ a.submitted_at|localtime }}</td>
          <td>{% if a.is_correct is None %}Не проверено{% elif a.is_correct %}Правильно{% else %}Неверно{% endif %}</td>
          <td>{{ a.answer_text }}</td>
          <td>
            <form id="mark_{{ a.id }}" method="post" data-base="/admin/game/{{ game.id }}/mark_answer/__ID__/" action="" style="display:inline">
              {% csrf_token %}
              <input type="hidden" name="action" value="">
              <input type="hidden" name="next" value="{{ request.path }}">
            </form>
            <button onclick="(function(){document.getElementById('mark_{{ a.id }}').action=document.getElementById('mark_{{ a.id }}').datasetBase.replace('__ID__','{{ a.id }}');document.getElementById('mark_{{ a.id }}').querySelector('input[name=action]').value='correct';document.getElementById('mark_{{ a.id }}').submit();})()">✔️</button>
            <button onclick="(function(){document.getElementById('mark_{{ a.id }}').action=document.getElementById('mark_{{ a.id }}').datasetBase.replace('__ID__','{{ a.id }}');document.getElementById('mark_{{ a.id }}').querySelector('input[name=action]').value='incorrect';document.getElementById('mark_{{ a.id }}').submit();})()">✖️</button>
          </td>
        </tr>
      {% empty %}
        <tr><td colspan="5">Нет ответов на этот вопрос</td></tr>
      {% endfor %}
    </tbody>
  </table>

</body>
</html>
